var re=Object.defineProperty,ne=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var H=(e,t,a)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,L=(e,t)=>{for(var a in t||(t={}))oe.call(t,a)&&H(e,a,t[a]);if(I)for(var a of I(t))le.call(t,a)&&H(e,a,t[a]);return e},E=(e,t)=>ne(e,se(t));import{u as ie}from"./user-Cu6cmzRD.js";import{b4 as ce,b5 as ue,aX as de,R as pe,Q as ge,ao as ve,au as fe,b6 as he}from"./bootstrap-DBsnWor2.js";import{aI as me,aO as Se,ad as x,aM as ye,F as xe,ac as $e,h as T,af as be,s as P,aJ as X,c as F,w as N,W as R,y as ze,aY as K,z as p,ai as C,K as Ce,ak as ke,bO as Ae,bP as _e,j as we,n as Pe,k as Oe,a6 as Be,u as j,cK as W}from"../jse/index-index-BUCZBWdu.js";const Re=e=>{const{antCls:t,componentCls:a,iconCls:r,avatarBg:o,avatarColor:g,containerSize:s,containerSizeLG:l,containerSizeSM:m,textFontSize:v,textFontSizeLG:u,textFontSizeSM:A,borderRadius:b,borderRadiusLG:i,borderRadiusSM:z,lineWidth:f,lineType:S}=e,d=(h,n,c)=>({width:h,height:h,lineHeight:`${h-f*2}px`,borderRadius:"50%",[`&${a}-square`]:{borderRadius:c},[`${a}-string`]:{position:"absolute",left:{_skip_check_:!0,value:"50%"},transformOrigin:"0 center"},[`&${a}-icon`]:{fontSize:n,[`> ${r}`]:{margin:0}}});return{[a]:x(x(x(x({},ye(e)),{position:"relative",display:"inline-block",overflow:"hidden",color:g,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:o,border:`${f}px ${S} transparent`,"&-image":{background:"transparent"},[`${t}-image-img`]:{display:"block"}}),d(s,v,b)),{"&-lg":x({},d(l,u,i)),"&-sm":x({},d(m,A,z)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},je=e=>{const{componentCls:t,groupBorderColor:a,groupOverlapping:r,groupSpace:o}=e;return{[`${t}-group`]:{display:"inline-flex",[`${t}`]:{borderColor:a},"> *:not(:first-child)":{marginInlineStart:r}},[`${t}-group-popover`]:{[`${t} + ${t}`]:{marginInlineStart:o}}}},U=me("Avatar",e=>{const{colorTextLightSolid:t,colorTextPlaceholder:a}=e,r=Se(e,{avatarBg:a,avatarColor:t});return[Re(r),je(r)]},e=>{const{controlHeight:t,controlHeightLG:a,controlHeightSM:r,fontSize:o,fontSizeLG:g,fontSizeXL:s,fontSizeHeading3:l,marginXS:m,marginXXS:v,colorBorderBg:u}=e;return{containerSize:t,containerSizeLG:a,containerSizeSM:r,textFontSize:Math.round((g+s)/2),textFontSizeLG:l,textFontSizeSM:o,groupSpace:v,groupOverlapping:-m,groupBorderColor:u}}),D=Symbol("AvatarContextKey"),Me=()=>xe(D,{}),Te=e=>$e(D,e),Fe=()=>({prefixCls:String,shape:{type:String,default:"circle"},size:{type:[Number,String,Object],default:()=>"default"},src:String,srcset:String,icon:be.any,alt:String,gap:Number,draggable:{type:Boolean,default:void 0},crossOrigin:String,loadError:{type:Function}}),k=T({compatConfig:{MODE:3},name:"AAvatar",inheritAttrs:!1,props:Fe(),slots:Object,setup(e,t){let{slots:a,attrs:r}=t;const o=P(!0),g=P(!1),s=P(1),l=P(null),m=P(null),{prefixCls:v}=X("avatar",e),[u,A]=U(v),b=Me(),i=F(()=>e.size==="default"?b.size:e.size),z=ce(),f=ue(()=>{if(typeof e.size!="object")return;const n=de.find($=>z.value[$]);return e.size[n]}),S=n=>f.value?{width:`${f.value}px`,height:`${f.value}px`,lineHeight:`${f.value}px`,fontSize:`${n?f.value/2:18}px`}:{},d=()=>{if(!l.value||!m.value)return;const n=l.value.offsetWidth,c=m.value.offsetWidth;if(n!==0&&c!==0){const{gap:$=4}=e;$*2<c&&(s.value=c-$*2<n?(c-$*2)/n:1)}},h=()=>{const{loadError:n}=e;(n==null?void 0:n())!==!1&&(o.value=!1)};return N(()=>e.src,()=>{R(()=>{o.value=!0,s.value=1})}),N(()=>e.gap,()=>{R(()=>{d()})}),ze(()=>{R(()=>{d(),g.value=!0})}),()=>{var n,c;const{shape:$,src:O,alt:V,srcset:q,draggable:J,crossOrigin:Q}=e,Y=(n=b.shape)!==null&&n!==void 0?n:$,_=K(a,e,"icon"),y=v.value,Z={[`${r.class}`]:!!r.class,[y]:!0,[`${y}-lg`]:i.value==="large",[`${y}-sm`]:i.value==="small",[`${y}-${Y}`]:!0,[`${y}-image`]:O&&o.value,[`${y}-icon`]:_,[A.value]:!0},ee=typeof i.value=="number"?{width:`${i.value}px`,height:`${i.value}px`,lineHeight:`${i.value}px`,fontSize:_?`${i.value/2}px`:"18px"}:{},G=(c=a.default)===null||c===void 0?void 0:c.call(a);let w;if(O&&o.value)w=p("img",{draggable:J,src:O,srcset:q,onError:h,alt:V,crossorigin:Q},null);else if(_)w=_;else if(g.value||s.value!==1){const B=`scale(${s.value}) translateX(-50%)`,te={msTransform:B,WebkitTransform:B,transform:B},ae=typeof i.value=="number"?{lineHeight:`${i.value}px`}:{};w=p(pe,{onResize:d},{default:()=>[p("span",{class:`${y}-string`,ref:l,style:x(x({},ae),te)},[G])]})}else w=p("span",{class:`${y}-string`,ref:l,style:{opacity:0}},[G]);return u(p("span",C(C({},r),{},{ref:m,class:Z,style:[ee,S(!!_),r.style]}),[w]))}}}),Ge=()=>({prefixCls:String,maxCount:Number,maxStyle:{type:Object,default:void 0},maxPopoverPlacement:{type:String,default:"top"},maxPopoverTrigger:String,size:{type:[Number,String,Object],default:"default"},shape:{type:String,default:"circle"}}),M=T({compatConfig:{MODE:3},name:"AAvatarGroup",inheritAttrs:!1,props:Ge(),setup(e,t){let{slots:a,attrs:r}=t;const{prefixCls:o,direction:g}=X("avatar",e),s=F(()=>`${o.value}-group`),[l,m]=U(o);return Ce(()=>{const v={size:e.size,shape:e.shape};Te(v)}),()=>{const{maxPopoverPlacement:v="top",maxCount:u,maxStyle:A,maxPopoverTrigger:b="hover",shape:i}=e,z={[s.value]:!0,[`${s.value}-rtl`]:g.value==="rtl",[`${r.class}`]:!!r.class,[m.value]:!0},f=K(a,e),S=ke(f).map((h,n)=>ge(h,{key:`avatar-key-${n}`})),d=S.length;if(u&&u<d){const h=S.slice(0,u),n=S.slice(u,d);return h.push(p(ve,{key:"avatar-popover-key",content:n,trigger:b,placement:v,overlayClassName:`${s.value}-popover`},{default:()=>[p(k,{style:A,shape:i},{default:()=>[`+${d-u}`]})]})),l(p("div",C(C({},r),{},{class:z,style:r.style}),[h]))}return l(p("div",C(C({},r),{},{class:z,style:r.style}),[S]))}}});k.Group=M;k.install=function(e){return e.component(k.name,k),e.component(M.name,M),e};const Ie={class:"absolute left-[50%-120px] top-[0px] flex h-[120px] w-[120px] cursor-pointer justify-center rounded-full bg-black opacity-0 hover:opacity-30"},We=T({__name:"update-avatar",props:{avatar:{type:String,default:""}},setup(e){const t=Ae(),a=_e(),r=F(()=>"/system/files/upload-image"),o={Authorization:`Bearer ${t.accessToken}`},g=s=>{s.file.status==="done"?ie({avatar:s.file.response.data.url}).then(()=>{var l;W.success("修改头像成功"),a.setUserInfo(E(L({},a.userInfo),{avatar:(l=s.file.response.data.fullUrl)!=null?l:s.file.response.data.url}))}):s.file.status==="error"&&W.error(`${s.file.name} file upload failed.`)};return(s,l)=>(Pe(),we(j(he),{action:r.value,headers:o,"max-count":1,"show-upload-list":!1,accept:"image/*",class:"relative",onChange:g},{default:Oe(()=>[p(j(k),{size:120,src:e.avatar},null,8,["src"]),Be("div",Ie,[p(j(fe),{size:48,icon:"ant-design:cloud-upload-outlined"})])]),_:1},8,["action"]))}});export{We as _};
