var E=Object.defineProperty,T=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var _=(a,t,e)=>t in a?E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,f=(a,t)=>{for(var e in t||(t={}))B.call(t,e)&&_(a,e,t[e]);if(C)for(var e of C(t))R.call(t,e)&&_(a,e,t[e]);return a},y=(a,t)=>T(a,z(t));var k=(a,t,e)=>new Promise((u,l)=>{var g=o=>{try{m(e.next(o))}catch(r){l(r)}},h=o=>{try{m(e.throw(o))}catch(r){l(r)}},m=o=>o.done?u(o.value):Promise.resolve(o.value).then(g,h);m((e=e.apply(a,t)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{g as x,d as S,l as V}from"./index-5Ft1jRh3.js";import{_ as D}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import{B as N,a3 as O,a$ as $}from"./bootstrap-DBsnWor2.js";import j from"./detail-BdaGNFn4.js";import G from"./form-DcuM-IKG.js";import{_ as I}from"./page.vue_vue_type_script_setup_true_lang-9XYPEXDE.js";import{h as U,b,j as q,n as K,k as d,z as s,u as p,Z as P,cK as Z}from"../jse/index-index-BUCZBWdu.js";import{u as H}from"./use-vxe-grid-CxZE6Hzc.js";import"./component-map-Dg1YW3q5.js";import"./index-1NUgD4WV.js";import"./Dropdown-G0jIiXp0.js";import"./description.vue_vue_type_script_setup_true_lang-CrOvFWHr.js";import"./index-BWzmO9nj.js";import"./use-modal-BGLiGhJB.js";import"./x-BAo__qRZ.js";import"./loading-BKAGElNW.js";const me=U({__name:"index",setup(a){const t=b(!1),e=b(),u=b(),l=b(!1),g=y(f({},x),{toolbarConfig:y(f({},x.toolbarConfig),{slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}}),height:"auto",keepSource:!0,pagerConfig:{enabled:!1},treeConfig:{transform:!1,rowField:"id",parentField:"pid"},proxyConfig:{ajax:{query:(c,be)=>k(this,[c,be],function*({page:n},i){return yield V(f({page:n.currentPage,limit:n.pageSize,format:"table_tree"},i))})},response:{list:""}}}),h={checkboxChange(n){t.value=n.records.length>0}},[m,o]=H({gridOptions:g,gridEvents:h}),r=n=>{e.value.setData({record:n,isUpdate:!1,gridApi:o}),e.value.open()},F=n=>{e.value.setData({record:n,isUpdate:!0,gridApi:o}),e.value.open()},A=n=>{u.value.setData({record:n}),u.value.open()},v=n=>{const i=[];n&&i.push(...$(n)),S(0,{data:i}).then(()=>{Z.success("删除成功"),o.reload()})},w=()=>{l.value?(o.grid.setAllTreeExpand(!1),l.value=!1):(o.grid.setAllTreeExpand(!0),l.value=!0)};return(n,i)=>(K(),q(p(I),{"auto-content-height":""},{default:d(()=>[s(p(m),null,{"toolbar-buttons":d(()=>[s(p(D),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["admin","system:dept:save"],onClick:r.bind(null,{})},{label:l.value?"折叠":"展开",type:"primary",icon:l.value?"ant-design:menu-fold-outlined":"ant-design:menu-unfold-outlined",onClick:w.bind(null)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:t.value,auth:["admin","system:dept:remove"],popConfirm:{title:"确定删除吗？",confirm:v.bind(null,!1)}}]},{more:d(()=>[s(p(N),{style:{"margin-left":"8px"}},{default:d(()=>[i[0]||(i[0]=P(" 批量操作 ")),s(p(O))]),_:1})]),_:1},8,["actions","drop-down-actions"])]),"toolbar-tools":d(()=>i[1]||(i[1]=[])),ACTION:d(({row:c})=>[s(p(D),{actions:[{label:"详情",type:"link",size:"small",auth:["admin","system:dept:detail"],onClick:A.bind(null,c)},{label:"编辑",type:"link",size:"small",auth:["admin","system:dept:update"],onClick:F.bind(null,c)}],"drop-down-actions":[{label:"添加下级",type:"link",icon:"ant-design:plus-outlined",size:"small",auth:["admin","system:dept:save"],onClick:r.bind(null,{pid:c.id})},{label:"删除",icon:"ant-design:delete-outlined",auth:["admin","sys:dept:remove"],popConfirm:{title:"确定删除吗？",confirm:v.bind(null,c)}}]},null,8,["actions","drop-down-actions"])]),_:1}),s(G,{ref_key:"deptFormRef",ref:e},null,512),s(j,{ref_key:"detailFormRef",ref:u},null,512)]),_:1}))}});export{me as default};
