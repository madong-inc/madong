var Ce=Object.defineProperty,we=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var N=(n,e,s)=>e in n?Ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,h=(n,e)=>{for(var s in e||(e={}))Oe.call(e,s)&&N(n,s,e[s]);if(ae)for(var s of ae(e))Te.call(e,s)&&N(n,s,e[s]);return n},A=(n,e)=>we(n,xe(e));var S=(n,e,s)=>N(n,typeof e!="symbol"?e+"":e,s);var P=(n,e,s)=>new Promise((b,d)=>{var T=u=>{try{V(s.next(u))}catch(k){d(k)}},$=u=>{try{V(s.throw(u))}catch(k){d(k)}},V=u=>u.done?b(u.value):Promise.resolve(u.value).then(T,$);V((s=s.apply(n,e)).next())});import{ce as O,cc as Ve,cd as ke,aD as x,bZ as Pe,cl as $e,h as de,cm as Fe,dd as Le,$ as Be,c as v,c9 as D,bR as Re,w as Ge,y as ze,L as Ae,V as re,n as j,z as E,bY as ne,k as f,a7 as ie,l as p,G as q,a6 as I,Z as le,j as Ee,_ as U,u as l,q as C,v as w,a2 as He,c0 as ce,c1 as J,a3 as _e,x as Me,Y as Ne,W as De,Q as je,J as qe}from"../jse/index-index-BUCZBWdu.js";import{aw as Ie,e as Ue,ax as Je,ay as We,az as Ye}from"./bootstrap-DBsnWor2.js";import{u as Ze,V as ue,a as Qe,e as Xe}from"./vxe-table-DN_3U_z_.js";import{V as Ke}from"./loading-BKAGElNW.js";function et(){return{class:"",gridClass:"",gridOptions:{},gridEvents:{},formOptions:void 0,showSearchForm:!0}}class tt{constructor(e={}){S(this,"formApi",{});S(this,"grid",{});S(this,"state",null);S(this,"store");S(this,"isMounted",!1);S(this,"stateHandler");const s=h({},e),b=et();this.store=new Ie(O(s,b),{onUpdate:()=>{this.state=this.store.state}}),this.state=this.store.state,this.stateHandler=new Ve,ke(this)}mount(e,s){!this.isMounted&&e&&(this.grid=e,this.formApi=s,this.stateHandler.setConditionTrue(),this.isMounted=!0)}query(){return P(this,arguments,function*(e={}){try{yield this.grid.commitProxy("query",x(e))}catch(s){console.error("Error occurred while querying:",s)}})}reload(){return P(this,arguments,function*(e={}){try{yield this.grid.commitProxy("reload",x(e))}catch(s){console.error("Error occurred while reloading:",s)}})}setGridOptions(e){this.setState({gridOptions:e})}setLoading(e){this.setState({gridOptions:{loading:e}})}setState(e){Pe(e)?this.store.setState(s=>O(e(s),s)):this.store.setState(s=>O(e,s))}toggleSearchForm(e){var s,b;return this.setState({showSearchForm:$e(e)?e:!((s=this.state)!=null&&s.showSearchForm)}),(b=this.state)==null?void 0:b.showSearchForm}unmount(){this.isMounted=!1,this.stateHandler.reset()}}const ot={class:"mr-1 pl-1 text-[1rem]"},st={class:"mt-2"},W="form-",H="toolbar-actions",Y="toolbar-tools",at=de({__name:"use-vxe-grid",props:{api:{},tableTitle:{},tableTitleHelp:{},class:{},gridClass:{},gridOptions:{},gridEvents:{},formOptions:{},showSearchForm:{type:Boolean}},setup(n){var G,K;const e=n,s=Fe("gridRef"),b=(K=(G=e.api)==null?void 0:G.useStore)==null?void 0:K.call(G),{gridOptions:d,class:T,gridClass:$,gridEvents:V,formOptions:u,tableTitle:k,tableTitleHelp:Z,showSearchForm:Q}=Le(e,b),{isMobile:me}=Ue(),i=Be(),[fe,c]=Ze({compact:!0,handleSubmit:()=>P(this,null,function*(){const t=yield c.getValues();c.setLatestSubmissionValues(x(t)),e.api.reload(t)}),handleReset:()=>P(this,null,function*(){yield c.resetForm();const t=yield c.getValues();c.setLatestSubmissionValues(t),e.api.reload(t)}),commonConfig:{componentProps:{class:"w-full"}},showCollapseButton:!0,submitButtonOptions:{content:v(()=>D("common.search"))},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"}),_=v(()=>{var t;return!!((t=i.tableTitle)!=null&&t.call(i))||k.value}),M=v(()=>{var t,o;return!!((t=i[H])!=null&&t.call(i))||!!((o=i[Y])!=null&&o.call(i))||_.value}),pe=v(()=>{var m,g,y,F,L,B,R;const t=(m=i[H])==null?void 0:m.call(i),o=(g=i[Y])==null?void 0:g.call(i),a={code:"search",icon:"vxe-icon--search",circle:!0,status:Q.value?"primary":void 0,title:D("common.search")},r={tools:(L=(F=(y=d.value)==null?void 0:y.toolbarConfig)==null?void 0:F.tools)!=null?L:[]};return(R=(B=d.value)==null?void 0:B.toolbarConfig)!=null&&R.search&&u.value&&(r.tools=Array.isArray(r.tools)?[...r.tools,a]:[a]),M.value?(r.slots=h(h({},t||_.value?{buttons:H}:{}),o?{tools:Y}:{}),{toolbarConfig:r}):{toolbarConfig:r}}),X=v(()=>{var a,r,m;const t=(m=(r=(a=ue)==null?void 0:a.getConfig())==null?void 0:r.grid)!=null?m:{},o=Re(O({},x(pe.value),x(d.value),t));if(o.proxyConfig){const{ajax:g}=o.proxyConfig;o.proxyConfig.enabled=!!g,o.proxyConfig.autoLoad=!1}if(o.pagerConfig){const g=["PrevJump","PrevPage","Number","NextPage","NextJump"],y=["Total","Sizes","Home",...g,"End"];o.pagerConfig=O({},o.pagerConfig,{pageSize:20,background:!0,pageSizes:[10,20,30,50,100,200],className:"mt-2 w-full",layouts:me.value?g:y,size:"mini"})}return o.formConfig&&(o.formConfig.enabled=!1),o});function ge(t){var o,a,r,m;t.code==="search"&&((a=(o=e.api)==null?void 0:o.toggleSearchForm)==null||a.call(o)),(m=(r=V.value)==null?void 0:r.toolbarToolClick)==null||m.call(r,t)}const he=v(()=>A(h({},V.value),{toolbarToolClick:ge})),be=v(()=>{const t=[];for(const o of Object.keys(i))["empty","form","loading",H].includes(o)||t.push(o);return t}),ve=v(()=>{const t=[];for(const o of Object.keys(i))o.startsWith(W)&&t.push(o);return t.map(o=>o.replace(W,""))});function ye(){return P(this,null,function*(){var g,y,F,L,B,R,ee,te,oe,z,se;yield De();const t=(F=(y=(g=ue)==null?void 0:g.getConfig())==null?void 0:y.grid)!=null?F:{},o=O({},x(d.value),x(t)),a=(L=o.proxyConfig)==null?void 0:L.autoLoad;((B=X.value.proxyConfig)==null?void 0:B.enabled)&&a&&((te=(ee=e.api.grid).commitProxy)==null||te.call(ee,"_init",u.value?(R=yield c.getValues())!=null?R:{}:{}));const m=(oe=d.value)==null?void 0:oe.formConfig;m&&m.enabled&&console.warn("[Vben Vxe Table]: The formConfig in the grid is not supported, please use the `formOptions` props"),(se=(z=e.api)==null?void 0:z.setState)==null||se.call(z,{gridOptions:o}),Xe(e.api,o,()=>c.getLatestSubmissionValues())})}Ge(u,()=>{c.setState(t=>{const o=O({},u.value,t);return A(h({},o),{collapseTriggerResize:!!o.showCollapseButton})})},{immediate:!0});const Se=v(()=>{var t;return(t=c.getState())==null?void 0:t.compact});return ze(()=>{var t,o;(o=(t=e.api)==null?void 0:t.mount)==null||o.call(t,s.value,c),ye()}),Ae(()=>{var t,o,a;(t=c==null?void 0:c.unmount)==null||t.call(c),(a=(o=e.api)==null?void 0:o.unmount)==null||a.call(o)}),(t,o)=>(j(),re("div",{class:ce(l(J)("bg-card h-full rounded-md",l(T)))},[E(l(Qe),Me({ref_key:"gridRef",ref:s,class:l(J)("p-2",{"pt-0":M.value&&!l(u)},l($))},X.value,Ne(he.value)),ne({form:f(()=>[l(u)?He((j(),re("div",{key:0,class:ce(l(J)("relative rounded py-3",Se.value?"pb-6":"pb-4"))},[p(t.$slots,"form",{},()=>[E(l(fe),null,ne({"reset-before":f(a=>[p(t.$slots,"reset-before",C(w(a)))]),"submit-before":f(a=>[p(t.$slots,"submit-before",C(w(a)))]),"expand-before":f(a=>[p(t.$slots,"expand-before",C(w(a)))]),"expand-after":f(a=>[p(t.$slots,"expand-after",C(w(a)))]),_:2},[ie(ve.value,a=>({name:a,fn:f(r=>[p(t.$slots,`${W}${a}`,C(w(r)))])}))]),1024)]),o[0]||(o[0]=I("div",{class:"bg-background-deep z-100 absolute -left-2 bottom-1 h-2 w-[calc(100%+1rem)] overflow-hidden md:bottom-2 md:h-3"},null,-1))],2)),[[_e,l(Q)!==!1]]):q("",!0)]),loading:f(()=>[p(t.$slots,"loading",{},()=>[E(l(Ke),{spinning:!0})])]),empty:f(()=>[p(t.$slots,"empty",{},()=>[E(l(We),{class:"mx-auto"}),I("div",st,U(l(D)("common.noData")),1)])]),_:2},[M.value?{name:"toolbar-actions",fn:f(a=>[_.value?p(t.$slots,"table-title",{key:0},()=>[I("div",ot,[le(U(l(k))+" ",1),l(Z)?(j(),Ee(l(Je),{key:0,"trigger-class":"pb-1"},{default:f(()=>[le(U(l(Z)),1)]),_:1})):q("",!0)])]):q("",!0),p(t.$slots,"toolbar-actions",C(w(a)))]),key:"0"}:void 0,ie(be.value,a=>({name:a,fn:f(r=>[p(t.$slots,a,C(w(r)))])}))]),1040,["class"])],2))}});function ut(n){const e=new tt(n),s=e;return s.useStore=d=>Ye(e.store,d),[de((d,{attrs:T,slots:$})=>(je(()=>{e.unmount()}),e.setState(h(h({},d),T)),()=>qe(at,A(h(h({},d),T),{api:s}),$)),{inheritAttrs:!1,name:"VbenVxeGrid"}),s]}export{ut as u};
