var D=Object.defineProperty,N=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var v=(r,o,e)=>o in r?D(r,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[o]=e,w=(r,o)=>{for(var e in o||(o={}))z.call(o,e)&&v(r,e,o[e]);if(x)for(var e of x(o))B.call(o,e)&&v(r,e,o[e]);return r},k=(r,o)=>N(r,V(o));var y=(r,o,e)=>new Promise((u,i)=>{var p=l=>{try{m(e.next(l))}catch(a){i(a)}},f=l=>{try{m(e.throw(l))}catch(a){i(a)}},m=l=>l.done?u(l.value):Promise.resolve(l.value).then(p,f);m((e=e.apply(r,o)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{b as E,c as O}from"./rbac-DZTRpzt1.js";import{B as T,au as K}from"./bootstrap-DBsnWor2.js";import{_ as R}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import{_ as L}from"./add-user.vue_vue_type_script_setup_true_lang-viAuznWA.js";import{h as P,b as h,V as U,n as S,z as s,k as c,u as d,Z as $,cK as G}from"../jse/index-index-BUCZBWdu.js";import{u as j}from"./use-vxe-grid-CxZE6Hzc.js";import{u as q}from"./use-drawer-JrzCmswA.js";const oe=P({__name:"user-role",setup(r,{expose:o}){const e=h(),u=h(!1),i=h(),p={collapsed:!0,commonConfig:{labelWidth:60},schema:[{component:"Input",fieldName:"LIKE_user_name",label:"用户名",componentProps:{placeholder:"请输入用户名",allowClear:!0}},{component:"Input",fieldName:"LIKE_real_name",label:"姓名",componentProps:{placeholder:"请输入姓名",allowClear:!0}},{component:"Input",fieldName:"LIKE_mobile_phone",label:"手机号码",componentProps:{placeholder:"请输入手机号码",allowClear:!0}}]},f={columns:[{type:"checkbox",width:60},{field:"user_name",title:"用户名"},{field:"real_name",title:"姓名"},{field:"mobile_phone",title:"手机号码"},{width:170,title:"操作",align:"center",slots:{default:"ACTION"},fixed:"right"}],toolbarConfig:{refresh:!0,print:!1,export:!1,zoom:!0,slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}},columnConfig:{resizable:!0},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(_,b)=>y(this,[_,b],function*({page:n},t){return yield O(k(w({page:n.currentPage,limit:n.pageSize},t),{role_id:e.value.id}))})}}},m={checkboxChange(){const n=a.grid.getCheckboxRecords();u.value=n.length>0},checkboxAll(){const n=a.grid.getCheckboxRecords();u.value=n.length>0}},[l,a]=j({formOptions:p,gridOptions:f,gridEvents:m}),[I,g]=q({footer:!1,onOpenChange(n){var t;e.value=n?(t=g.getData())==null?void 0:t.record:{}}}),A=()=>{i.value.setData({record:e.value,gridApi:a}),i.value.open()},C=n=>{let t=[];n?t.push(n.id):t=a.grid.getCheckboxRecords().map(b=>b.id);const _=t.map(b=>({user_id:b,role_id:e.value.id}));E(_).then(()=>{G.success("删除成功"),a.reload()})};return o(g),(n,t)=>(S(),U("div",null,[s(d(I),{class:"w-[60%]",title:"成员管理"},{default:c(()=>[s(d(l),null,{"toolbar-buttons":c(()=>[s(d(R),{actions:[{label:"添加用户",type:"primary",icon:"ant-design:plus-outlined",auth:["admin","system:rbac:user_role"],onClick:A.bind(null)}],"drop-down-actions":[{label:"移除用户",icon:"ant-design:delete-outlined",ifShow:u.value,auth:["admin","system:rbac:remove_user_role"],popConfirm:{title:"确定移除用户吗？",confirm:C.bind(null,!1)}}]},{more:c(()=>[s(d(T),{style:{"margin-left":"8px"}},{default:c(()=>[t[0]||(t[0]=$(" 批量操作 ")),s(d(K),{icon:"ant-design:down-outlined"})]),_:1})]),_:1},8,["actions","drop-down-actions"])]),ACTION:c(({row:_})=>[s(d(R),{actions:[{label:"移除用户",type:"link",icon:"ant-design:delete-outlined",size:"small",auth:["admin","system:rbac:remove_user_role"],popConfirm:{title:"确定移除用户吗？",confirm:C.bind(null,_)}}]},null,8,["actions"])]),"toolbar-tools":c(()=>t[1]||(t[1]=[])),_:1})]),_:1}),s(L,{ref_key:"addUserRef",ref:i},null,512)]))}});export{oe as _};
