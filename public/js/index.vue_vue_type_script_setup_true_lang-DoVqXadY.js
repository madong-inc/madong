var N=Object.defineProperty,S=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var _=(o,t,e)=>t in o?N(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,d=(o,t)=>{for(var e in t||(t={}))D.call(t,e)&&_(o,e,t[e]);if(h)for(var e of h(t))T.call(t,e)&&_(o,e,t[e]);return o},u=(o,t)=>S(o,A(t));var C=(o,t,e)=>new Promise((f,m)=>{var g=r=>{try{a(e.next(r))}catch(n){m(n)}},b=r=>{try{a(e.throw(r))}catch(n){m(n)}},a=r=>r.done?f(r.value):Promise.resolve(r.value).then(g,b);a((e=e.apply(o,t)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{bN as k,h as O,b as B,j as I,n as V,u as s,k as l,z as p,Z as x,_ as $,cK as z}from"../jse/index-index-BUCZBWdu.js";import{_ as w}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import{u as E}from"./use-vxe-grid-CxZE6Hzc.js";import{_ as P}from"./page.vue_vue_type_script_setup_true_lang-9XYPEXDE.js";import{B as R,a3 as j}from"./bootstrap-DBsnWor2.js";const v="/monitor/crontab-log",q=o=>k.get(v,{params:o}),G=(o,t)=>k.delete(`${v}/${o}`,{data:t}),y={toolbarConfig:{refresh:!0,print:!1,export:!1,zoom:!0},columns:[{type:"checkbox",width:60},{field:"target",title:"调用目标",width:170},{field:"running_time",title:"执行耗时"},{field:"return_code",title:"状态",slots:{default:"returnCode"}},{field:"log",title:"执行日志"},{field:"create_time",title:"执行时间"},{width:160,title:"操作",align:"center",slots:{default:"ACTION"},fixed:"right"}]},K={schema:[{component:"Input",fieldName:"LIKE_target",label:"调用目标",componentProps:{placeholder:"请输入调用目标",allowClear:!0}},{component:"ApiDict",fieldName:"EQ_enabled",label:"是否成功",componentProps:{placeholder:"请选择",allowClear:!0,code:"yes_no",renderType:"Select"}}]},W=O({__name:"index",props:{crontab_id:{type:[String,Number],default:void 0}},setup(o){const t=o,e=B(!1),f=u(d({},K),{collapsed:!0}),m=u(d({},y),{toolbarConfig:u(d({},y.toolbarConfig),{slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}}),height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(c,ee)=>C(this,[c,ee],function*({page:n},i){return yield q(u(d({page:n.currentPage,limit:n.pageSize},i),{crontab_id:t.crontab_id}))})}}}),g={checkboxChange(){const n=a.grid.getCheckboxRecords();e.value=n.length>0},checkboxAll(){const n=a.grid.getCheckboxRecords();e.value=n.length>0}},[b,a]=E({formOptions:f,gridOptions:m,gridEvents:g}),r=n=>{let i=[];n?i.push(n.id):i=a.grid.getCheckboxRecords().map(c=>c.id),G(0,{data:i}).then(()=>{z.success("删除成功"),a.reload()})};return(n,i)=>(V(),I(s(P),{"auto-content-height":""},{default:l(()=>[p(s(b),null,{"toolbar-buttons":l(()=>[p(s(w),{actions:[],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:e.value,auth:["admin","monitor:crontab_log:remove"],popConfirm:{title:"确定删除吗？",confirm:r.bind(null,!1)}}]},{more:l(()=>[p(s(R),{style:{"margin-left":"8px"}},{default:l(()=>[i[0]||(i[0]=x(" 批量操作 ")),p(s(j))]),_:1})]),_:1},8,["drop-down-actions"])]),returnCode:l(({row:c})=>[x($(c.return_code==0?"成功":"失败"),1)]),"toolbar-tools":l(()=>i[1]||(i[1]=[])),ACTION:l(({row:c})=>[p(s(w),{actions:[],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",auth:["admin","system:crontab_log:remove"],popConfirm:{title:"确定删除吗？",confirm:r.bind(null,c)}}]},null,8,["drop-down-actions"])]),_:1})]),_:1}))}});export{W as _};
