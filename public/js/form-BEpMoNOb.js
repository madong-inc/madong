var A=Object.defineProperty;var w=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var V=(t,s,e)=>s in t?A(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,b=(t,s)=>{for(var e in s||(s={}))y.call(s,e)&&V(t,e,s[e]);if(w)for(var e of w(s))C.call(s,e)&&V(t,e,s[e]);return t};var _=(t,s,e)=>new Promise((r,n)=>{var g=a=>{try{c(e.next(a))}catch(o){n(o)}},i=a=>{try{c(e.throw(a))}catch(o){n(o)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(g,i);c((e=e.apply(t,s)).next())});import{u as D}from"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{c as S,d as U,s as k}from"./user-Cu6cmzRD.js";import{f as B}from"./index-s-IQaRr9.js";import{h as F,b as h,u as p,cK as N,j as K,n as L,k as M,a6 as P,z as j}from"../jse/index-index-BUCZBWdu.js";import{u as z}from"./use-modal-BGLiGhJB.js";import{s as I,aK as T}from"./bootstrap-DBsnWor2.js";import"./component-map-Dg1YW3q5.js";import"./x-BAo__qRZ.js";import"./loading-BKAGElNW.js";const $={class:"common-form"},q=F({__name:"form",setup(t,{expose:s}){const e=h(),r=h(!1),n=h(),[g,i]=D(b({showDefaultActions:!1},B)),[c,a]=z({draggable:!0,onOpenChange(o){var l,m,d,f,u;r.value||i.updateSchema([{fieldName:"confirmPassword",rules:I().regex(/[\w!@#$%^&*]{5,18}/,"密码由5-18位数字、字母、特殊字符组成。").refine(v=>_(this,null,function*(){const x=yield i.getValues();return v===x.password}),{message:"确认密码必须与密码一致"})}]),r.value=(m=(l=a.getData())==null?void 0:l.isUpdate)!=null?m:!1,e.value=o?((d=a.getData())==null?void 0:d.record)||{}:{},n.value=o?(f=a.getData())==null?void 0:f.gridApi:null,o&&r.value?k((u=e.value)==null?void 0:u.id).then(v=>{i.setValues(v)}):i.setValues(e.value)},onConfirm(){i.validate().then(o=>_(this,null,function*(){var l;if(o.valid){const m=yield i.getValues();a.setState({loading:!0,confirmLoading:!0});const d=p(r)?S:U,f=p(r)?[(l=e.value)==null?void 0:l.id,m]:[m];d(...f).then(()=>{var u;N.success("保存成功"),(u=n.value)==null||u.reload(),a.close()}).finally(()=>{a.setState({loading:!1,confirmLoading:!1})})}}))}});return s(a),(o,l)=>(L(),K(p(c),{title:r.value?"编辑用户":"新增用户",class:"w-[50%]"},{default:M(()=>[P("div",$,[j(p(g))])]),_:1},8,["title"]))}}),ee=T(q,[["__scopeId","data-v-df4020db"]]);export{ee as default};
