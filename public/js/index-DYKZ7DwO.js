var B=Object.defineProperty,M=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var C=(n,o,e)=>o in n?B(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,b=(n,o)=>{for(var e in o||(o={}))V.call(o,e)&&C(n,e,o[e]);if(v)for(var e of v(o))$.call(o,e)&&C(n,e,o[e]);return n},_=(n,o)=>M(n,T(o));var x=(n,o,e)=>new Promise((c,r)=>{var p=l=>{try{f(e.next(l))}catch(h){r(h)}},y=l=>{try{f(e.throw(l))}catch(h){r(h)}},f=l=>l.done?c(l.value):Promise.resolve(l.value).then(p,y);f((e=e.apply(n,o)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{g as R,d as N,b as O,l as U}from"./index-DGgvaZdm.js";import{B as j,au as E}from"./bootstrap-DBsnWor2.js";import{_ as D}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import G from"./auth-menu-BSl0uqwP.js";import q from"./detail-DDJSAivr.js";import I from"./form-aBjKWnmr.js";import{_ as K}from"./user-role.vue_vue_type_script_setup_true_lang-DsfwAJcL.js";import{_ as P}from"./page.vue_vue_type_script_setup_true_lang-9XYPEXDE.js";import{h as Z,b as g,j as H,n as J,k as d,z as i,u,Z as L,cK as Q}from"../jse/index-index-BUCZBWdu.js";import{u as W}from"./use-vxe-grid-CxZE6Hzc.js";import"./component-map-Dg1YW3q5.js";import"./index-1NUgD4WV.js";import"./Dropdown-G0jIiXp0.js";import"./menu-C7Vk5aXg.js";import"./rbac-DZTRpzt1.js";import"./use-drawer-JrzCmswA.js";import"./x-BAo__qRZ.js";import"./loading-BKAGElNW.js";import"./description.vue_vue_type_script_setup_true_lang-CrOvFWHr.js";import"./index-BWzmO9nj.js";import"./use-modal-BGLiGhJB.js";import"./add-user.vue_vue_type_script_setup_true_lang-viAuznWA.js";const xe=Z({__name:"index",setup(n){const o=g(!1),e=g(),c=g(),r=g(),p=g(),y=_(b({},O),{collapsed:!0}),f=_(b({},R),{toolbarConfig:_(b({},R.toolbarConfig),{slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}}),height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(s,Ae)=>x(this,[s,Ae],function*({page:t},a){return yield U(b({page:t.currentPage,limit:t.pageSize},a))})}}}),l={checkboxChange(){const t=m.grid.getCheckboxRecords();o.value=t.length>0},checkboxAll(){const t=m.grid.getCheckboxRecords();o.value=t.length>0}},[h,m]=W({formOptions:y,gridOptions:f,gridEvents:l}),A=()=>{e.value.setData({isUpdate:!1,gridApi:m}),e.value.open()},F=t=>{e.value.setData({record:t,isUpdate:!0,gridApi:m}),e.value.open()},z=t=>{c.value.setData({record:t}),c.value.open()},k=t=>{let a=[];t?a.push(t.id):a=m.grid.getCheckboxRecords().map(s=>s.id),N(0,{data:a}).then(()=>{Q.success("删除成功"),m.reload()})},S=t=>{r.value.setData({record:t}),r.value.open()},w=t=>{p.value.setData({record:t}),p.value.open()};return(t,a)=>(J(),H(u(P),{"auto-content-height":""},{default:d(()=>[i(u(h),null,{"toolbar-buttons":d(()=>[i(u(D),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["admin","system:role:save"],onClick:A.bind(null)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:o.value,auth:["admin","system:role:remove"],popConfirm:{title:"确定删除吗？",confirm:k.bind(null,!1)}}]},{more:d(()=>[i(u(j),{style:{"margin-left":"8px"}},{default:d(()=>[a[0]||(a[0]=L(" 批量操作 ")),i(u(E),{icon:"ant-design:down-outlined"})]),_:1})]),_:1},8,["actions","drop-down-actions"])]),"toolbar-tools":d(()=>a[1]||(a[1]=[])),ACTION:d(({row:s})=>[i(u(D),{actions:[{label:"详情",type:"link",size:"small",auth:["admin","system:role:detail"],onClick:z.bind(null,s)},{label:"授权",type:"link",size:"small",auth:["admin","system:rbac:save_role_menu"],onClick:S.bind(null,s)},{label:"用户",type:"link",size:"small",auth:["admin","system:rbac:user_list_by_role_id"],onClick:w.bind(null,s)}],"drop-down-actions":[{label:"编辑",icon:"ant-design:edit-outlined",type:"link",size:"small",auth:["admin","system:role:update"],onClick:F.bind(null,s)},{label:"删除",icon:"ant-design:delete-outlined",auth:["admin","system:role:remove"],popConfirm:{title:"确定删除吗？",confirm:k.bind(null,s)}}]},null,8,["actions","drop-down-actions"])]),_:1}),i(I,{ref_key:"roleFormRef",ref:e},null,512),i(q,{ref_key:"detailFormRef",ref:c},null,512),i(G,{ref_key:"authMenuRef",ref:r},null,512),i(K,{ref_key:"userRoleRef",ref:p},null,512)]),_:1}))}});export{xe as default};
