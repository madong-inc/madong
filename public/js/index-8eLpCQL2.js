var T=Object.defineProperty,V=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var v=(s,a,o)=>a in s?T(s,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[a]=o,p=(s,a)=>{for(var o in a||(a={}))E.call(a,o)&&v(s,o,a[o]);if(x)for(var o of x(a))L.call(a,o)&&v(s,o,a[o]);return s},b=(s,a)=>V(s,$(a));var y=(s,a,o)=>new Promise((c,f)=>{var g=n=>{try{m(o.next(n))}catch(u){f(u)}},C=n=>{try{m(o.throw(n))}catch(u){f(u)}},m=n=>n.done?c(n.value):Promise.resolve(n.value).then(g,C);m((o=o.apply(s,a)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{g as R,C as N,r as O,p as j,e as G,d as P,s as U,l as W}from"./form-DuxmMHST.js";import{B as q,au as I}from"./bootstrap-DBsnWor2.js";import{_ as z}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import{_ as K}from"./logs-wrap.vue_vue_type_script_setup_true_lang-D8V97cFP.js";import{_ as Z}from"./page.vue_vue_type_script_setup_true_lang-9XYPEXDE.js";import{h as w,b as k,j as H,n as J,k as r,z as l,u as d,Z as M,cK as h}from"../jse/index-index-BUCZBWdu.js";import{u as Q}from"./use-vxe-grid-CxZE6Hzc.js";import"./component-map-Dg1YW3q5.js";import"./use-modal-BGLiGhJB.js";import"./x-BAo__qRZ.js";import"./loading-BKAGElNW.js";import"./index-1NUgD4WV.js";import"./Dropdown-G0jIiXp0.js";import"./index.vue_vue_type_script_setup_true_lang-DoVqXadY.js";import"./use-drawer-JrzCmswA.js";const he=w({__name:"index",setup(s){const a=k(!1),o=k(),c=k(),f=b(p({},U),{collapsed:!0}),g=b(p({},R),{toolbarConfig:b(p({},R.toolbarConfig),{slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}}),height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(i,ke)=>y(this,[i,ke],function*({page:e},t){return yield W(p({page:e.currentPage,limit:e.pageSize},t))})}}}),C={checkboxChange(){const e=n.grid.getCheckboxRecords();a.value=e.length>0},checkboxAll(){const e=n.grid.getCheckboxRecords();a.value=e.length>0}},[m,n]=Q({formOptions:f,gridOptions:g,gridEvents:C}),u=()=>{console.log(o.value),o.value.setData({isUpdate:!1,gridApi:n}),o.value.open()},S=e=>{o.value.setData({record:e,isUpdate:!0,gridApi:n}),o.value.open()},D=e=>{let t=[];e?t.push(e.id):t=n.grid.getCheckboxRecords().map(i=>i.id),O({data:t}).then(()=>{h.success("恢复成功"),n.reload()})},A=e=>{let t=[];e?t.push(e.id):t=n.grid.getCheckboxRecords().map(i=>i.id),j({data:t}).then(()=>{h.success("执行成功"),n.reload()})},B=e=>{let t=[];e?t.push(e.id):t=n.grid.getCheckboxRecords().map(i=>i.id),G({data:t}).then(()=>{h.success("执行成功"),n.reload()})},_=e=>{let t=[];e?t.push(e.id):t=n.grid.getCheckboxRecords().map(i=>i.id),P(0,{data:t}).then(()=>{h.success("删除成功"),n.reload()})},F=e=>{c.value.setData({record:e}),c.value.open()};return(e,t)=>(J(),H(d(Z),{"auto-content-height":""},{default:r(()=>[l(d(m),null,{"toolbar-buttons":r(()=>[l(d(z),{actions:[{label:"新增",type:"primary",icon:"ant-design:plus-outlined",auth:["admin","monitor:crontab:save"],onClick:u.bind(null)}],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:a.value,auth:["admin","monitor:crontab:remove"],popConfirm:{title:"确定删除吗？",confirm:_.bind(null,!1)}}]},{more:r(()=>[l(d(q),{style:{"margin-left":"8px"}},{default:r(()=>[t[0]||(t[0]=M(" 批量操作 ")),l(d(I),{icon:"ant-design:down-outlined"})]),_:1})]),_:1},8,["actions","drop-down-actions"])]),"toolbar-tools":r(()=>t[1]||(t[1]=[])),ACTION:r(({row:i})=>[l(d(z),{actions:[{label:"执行",type:"link",size:"small",auth:["admin","monitor:crontab:detail"],popConfirm:{title:"确定执行该任务？",confirm:B.bind(null,i)}},{label:"编辑",type:"link",size:"small",auth:["admin","monitor:crontab:update"],onClick:S.bind(null,i)},{label:"日志",type:"link",size:"small",auth:["admin","monitor:crontab:logs"],onClick:F.bind(null,i)}],"drop-down-actions":[{label:"启动",type:"link",size:"small",icon:"ant-design:play-circle-outlined",auth:["admin","monitor:crontab:resume"],ifShow(){return i.enabled===0},popConfirm:{title:"确定启动该任务？",confirm:D.bind(null,i)}},{label:"停止",type:"link",size:"small",icon:"ant-design:pause-outlined",auth:["admin","monitor:crontab:pause"],ifShow(){return i.enabled===1},popConfirm:{title:"确定停止该任务？",confirm:A.bind(null,i)}},{label:"删除",icon:"ant-design:delete-outlined",auth:["admin","monitor:crontab:remove"],popConfirm:{title:"确定删除吗？",confirm:_.bind(null,i)}}]},null,8,["actions","drop-down-actions"])]),_:1}),l(N,{ref_key:"crontabFormRef",ref:o},null,512),l(K,{ref_key:"crontabLogsWrapRef",ref:c},null,512)]),_:1}))}});export{he as default};
