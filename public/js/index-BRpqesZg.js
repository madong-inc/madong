var L=Object.defineProperty,N=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var x=(n,e,o)=>e in n?L(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,p=(n,e)=>{for(var o in e||(e={}))z.call(e,o)&&x(n,o,e[o]);if(_)for(var o of _(e))O.call(e,o)&&x(n,o,e[o]);return n},b=(n,e)=>N(n,R(e));var k=(n,e,o)=>new Promise((h,u)=>{var g=a=>{try{d(o.next(a))}catch(t){u(t)}},i=a=>{try{d(o.throw(a))}catch(t){u(t)}},d=a=>a.done?h(a.value):Promise.resolve(a.value).then(g,i);d((o=o.apply(n,e)).next())});import"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{B as A,a3 as B,b0 as D,b1 as E,b2 as P}from"./bootstrap-DBsnWor2.js";import{_ as y}from"./table-action.vue_vue_type_script_setup_true_lang-Bo6k7XMX.js";import{_ as S}from"./page.vue_vue_type_script_setup_true_lang-9XYPEXDE.js";import{h as T,b as w,j as U,n as j,k as s,z as f,u as c,Z as K,cK as V}from"../jse/index-index-BUCZBWdu.js";import{u as G}from"./use-vxe-grid-CxZE6Hzc.js";import"./component-map-Dg1YW3q5.js";import"./index-1NUgD4WV.js";import"./Dropdown-G0jIiXp0.js";import"./loading-BKAGElNW.js";const I={toolbarConfig:{refresh:!0,print:!1,export:!1,zoom:!0},columnConfig:{resizable:!0},columns:[{type:"checkbox",width:60},{field:"filename",title:"名字",align:"left",width:200},{field:"original_filename",title:"文件"},{field:"size_info",title:"文件大小"},{field:"ext",title:"扩展名"},{field:"platform",title:"存储平台"},{field:"create_time",title:"创建时间"},{field:"created_name",title:"上传人"},{width:170,title:"操作",align:"center",slots:{default:"ACTION"},fixed:"right"}]},$={schema:[{component:"Input",fieldName:"LIKE_filename",label:"文件名",componentProps:{placeholder:"文件名称",allowClear:!0}},{component:"Input",fieldName:"LIKE_original_filename",label:"原名称",componentProps:{placeholder:"请输入唯一编码",allowClear:!0}},{component:"Input",fieldName:"LIKE_ext",label:"扩展名",componentProps:{placeholder:"请输入扩展名称",allowClear:!0}},{component:"Input",fieldName:"IN_platform",label:"平台",componentProps:{placeholder:"请输选择平台",allowClear:!0}}]},te=T({__name:"index",setup(n){const e=w(!1);w(),w();const o=b(p({},$),{collapsed:!0,wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"}),h=b(p({},I),{toolbarConfig:b(p({},I.toolbarConfig),{slots:{buttons:"toolbar-buttons"},custom:{icon:"vxe-icon-menu"}}),height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(m,C)=>k(this,[m,C],function*({page:t},l){return yield P(p({page:t.currentPage,limit:t.pageSize},l))})}}}),u={checkboxChange(){const t=i.grid.getCheckboxRecords();e.value=t.length>0},checkboxAll(){const t=i.grid.getCheckboxRecords();e.value=t.length>0}},[g,i]=G({formOptions:o,gridOptions:h,gridEvents:u}),d=t=>{D(t.id).then(l=>{const m=new Blob([l]),C=window.URL.createObjectURL(m),r=document.createElement("a");r.style.display="none",r.href=C;const v=t.filename||"downloaded-file";r.setAttribute("download",v),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(C)}).catch(l=>{console.error("下载失败:",l)})},a=t=>{let l=[];t?l.push(t.id):l=i.grid.getCheckboxRecords().map(m=>m.id),E(0,{data:l!=null?l:[]}).then(()=>{V.success("删除成功"),i.reload()})};return(t,l)=>(j(),U(c(S),{"auto-content-height":""},{default:s(()=>[f(c(g),null,{"toolbar-buttons":s(()=>[f(c(y),{actions:[],"drop-down-actions":[{label:"删除",icon:"ant-design:delete-outlined",ifShow:e.value,auth:["admin","system:files:remove"],popConfirm:{title:"确定删除吗？",confirm:a.bind(null,!1)}}]},{more:s(()=>[f(c(A),{style:{"margin-left":"8px"}},{default:s(()=>[l[0]||(l[0]=K(" 批量操作 ")),f(c(B))]),_:1})]),_:1},8,["drop-down-actions"])]),"toolbar-tools":s(()=>l[1]||(l[1]=[])),ACTION:s(({row:m})=>[f(c(y),{actions:[{label:"下载",type:"link",size:"small",auth:["admin","system:files:download"],onClick:d.bind(null,m)},{label:"删除",type:"link",size:"small",auth:["admin","system:files:remove"],popConfirm:{title:"确定删除吗？",confirm:a.bind(null,!1)}}],"drop-down-actions":[]},null,8,["actions"])]),_:1})]),_:1}))}});export{te as default};
