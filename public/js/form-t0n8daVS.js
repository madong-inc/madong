var b=Object.defineProperty;var h=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var V=(l,s,e)=>s in l?b(l,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[s]=e,w=(l,s)=>{for(var e in s||(s={}))F.call(s,e)&&V(l,e,s[e]);if(h)for(var e of h(s))N.call(s,e)&&V(l,e,s[e]);return l};var o=(l,s,e)=>new Promise((r,c)=>{var v=a=>{try{u(e.next(a))}catch(n){c(n)}},t=a=>{try{u(e.throw(a))}catch(n){c(n)}},u=a=>a.done?r(a.value):Promise.resolve(a.value).then(v,t);u((e=e.apply(l,s)).next())});import{u as A}from"./form-CnpKYFzH.js";import"./vxe-table-DN_3U_z_.js";import{u as x,a as k,s as C}from"./menu-C7Vk5aXg.js";import{f as D}from"./index-B3C5Y8qO.js";import{h as M,b as _,u as y,cK as S,j as B,n as K,k as L,a6 as U,z as j}from"../jse/index-index-BUCZBWdu.js";import{u as z}from"./use-modal-BGLiGhJB.js";import{aK as I}from"./bootstrap-DBsnWor2.js";import"./component-map-Dg1YW3q5.js";import"./x-BAo__qRZ.js";import"./loading-BKAGElNW.js";const P={class:"common-form"},T=M({__name:"form",setup(l,{expose:s}){const e=_(),r=_(!1),c=_(),[v,t]=A(w({showDefaultActions:!1},D)),[u,a]=z({draggable:!0,onOpenChange(n){var d,p,f,g,m;r.value=(p=(d=a.getData())==null?void 0:d.isUpdate)!=null?p:!1,e.value=n?((f=a.getData())==null?void 0:f.record)||{}:{},c.value=n?(g=a.getData())==null?void 0:g.gridApi:null,n&&t.updateSchema([{fieldName:"component",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![1,2].includes(i.type)})}},{fieldName:"open_type",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){return(yield t.getValues()).type!==2})}},{fieldName:"path",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![1,2,4].includes(i.type)})}},{fieldName:"icon",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![1,2].includes(i.type)})}},{fieldName:"link_url",dependencies:{triggerFields:["open_type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![2,3].includes(i.openType)})}},{fieldName:"is_show",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![1,2].includes(i.type)})}},{fieldName:"is_cache",dependencies:{triggerFields:["type"],disabled:()=>o(this,null,function*(){const i=yield t.getValues();return![1,2].includes(i.type)})}}]),n&&r.value?C((m=e.value)==null?void 0:m.id).then(i=>{t.setValues(i)}):t.setValues(e.value)},onConfirm(){t.validate().then(n=>o(this,null,function*(){var d;if(n.valid){const p=yield t.getValues();a.setState({loading:!0,confirmLoading:!0});const f=y(r)?x:k,g=y(r)?[(d=e.value)==null?void 0:d.id,p]:[p];f(...g).then(()=>{var m;S.success("保存成功"),(m=c.value)==null||m.reload(),a.close()}).finally(()=>{a.setState({loading:!1,confirmLoading:!1})})}}))}});return s(a),(n,d)=>(K(),B(y(u),{title:r.value?"编辑菜单":"新增菜单",class:"w-[60%]"},{default:L(()=>[U("div",P,[j(y(v))])]),_:1},8,["title"]))}}),$=I(T,[["__scopeId","data-v-9a696a0c"]]);export{$ as default};
